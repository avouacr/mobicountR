
install.packages("~/mobicount-project/minior-master.tar.gz", repos = NULL)
install.packages("fst")

library(minior)
library(fst)
library(data.table)

set_minio_shared()

# Indoor

get_file_local("MobiCount/fv/csg_02_19/fv_csg_indoor_02_2019.csv",
               "etgtk6",
               ext_dir = "~/fv")

indoor <- fread("~/fv/fv_csg_indoor_02_2019.csv")

indoor <- indoor[dma_name != "65535_-1_1700"] # Remove summary map

write_fst(indoor, "~/fv/indoor_02_19.fst", compress = 100, uniform_encoding = TRUE)

put_local_file("~/fv/indoor_02_19.fst", 
               dir_minio = "MobiCount/fv/csg_02_19",
               bucket = "etgtk6")


# Outdoor

get_file_local("MobiCount/fv/csg_02_19/fv_csg_outdoor_02_2019.tar.bz2",
               "etgtk6",
               ext_dir = "~/fv")

untar("/home/etgtk6/fv/fv_csg_outdoor_02_2019.tar.bz2",
      exdir = "/home/etgtk6/fv")

outdoor <- fread("~/fv/fv_csg_outdoor_02_2019.csv")

outdoor <- outdoor[dma_name != "65535_-1_1700"] # Remove summary map

write_fst(outdoor, "~/fv/outdoor_02_19.fst", compress = 100, 
          uniform_encoding = TRUE)

put_local_file("~/fv/outdoor_02_19.fst", 
               dir_minio = "MobiCount/fv/csg_02_19",
               bucket = "etgtk6")



